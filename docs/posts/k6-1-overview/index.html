<!doctype html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> k6 series [1] - Overview - Dyrone Teng </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta property="og:site_name" content="Dyrone Teng" />
    <meta property="og:locale" content="en_US" />

    <meta property="og:title" content="k6 series [1] - Overview" />
<meta property="og:description" content="NOTICE: Base and excerpt from the official k6 documentation
 Install export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles  mac :  brew install k6 More install supporst in https://k6.io/docs/getting-started/installation/
Concepts   virtual users (VUs): VUs are essentially parallel while(true) loop.
  init context: use the default function, this function defines the entry point for your VUsi. Init code runs first and is called only once per VU. On the other hand, default code executes as many times as the test options set." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/k6-1-overview/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-01T21:24:42+08:00" />
<meta property="article:modified_time" content="2022-08-01T21:24:42+08:00" />



    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:title" content="k6 series [1] - Overview" />
    <meta name="twitter:description" content="" />
    

    <meta name="twitter:image" content="" />
    <link rel="canonical" href="/posts/k6-1-overview/">
    
    <link rel="stylesheet" href="/css/site.min.css" />
    <link rel="stylesheet" href="css/custom.css" />

    
    
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Dyrone Teng" />
    
  </head>

  <body>
    
<div class="mt-xl header">
  <header>
    <div class="container">
      <div class="row justify-content-center">
	<div class="col-auto">
	  <a href="" style="display: contents">
	    <h1 class="name text-center">Teng Long Is Dyrone</h1>
	  </a>
	</div>
      </div>
      <div class="row justify-content-center">
	<div class="nav justify-content-center">
	  <ul>
	    
	    <li class="nav-item justify-content-center mx-auto"> 
	      <a class="nav-link" href="/">
		
		Home
	      </a>
	    </li>
	    
	    <li class="nav-item justify-content-center mx-auto"> 
	      <a class="nav-link" href="/posts/introduce/index.html">
		
		About
	      </a>
	    </li>
	    
	    
	  </ul>
	</div>
      </div>
    </div>
  </header>
</div>

<div class="content">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-lg-8">
        <h1 class="mx-0 mx-md-4 single-page-title">k6 series [1] - Overview</h1>
        <div class="markdown page-content">
          <blockquote>
<p>NOTICE: Base and excerpt from the official k6 documentation</p>
</blockquote>
<h2 id="install">Install</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#204a87">export</span> <span style="color:#000">HOMEBREW_BOTTLE_DOMAIN</span><span style="color:#ce5c00;font-weight:bold">=</span>https://mirrors.ustc.edu.cn/homebrew-bottles
</code></pre></div><ul>
<li>mac :</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">brew install k6
</code></pre></div><p>More install supporst in <a href="https://k6.io/docs/getting-started/installation/">https://k6.io/docs/getting-started/installation/</a></p>
<h2 id="concepts">Concepts</h2>
<ul>
<li>
<p>virtual users (VUs):  VUs are essentially parallel while(true) loop.</p>
</li>
<li>
<p>init context: use the default function, this function defines the entry point
for your VUsi. Init code runs first and is called only once per VU. On the other
hand, default code executes as many times as the test options set.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// vu code: do things here...
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="test-life-cycle">Test life cycle</h2>
<p>In last section, we introduced the init context, here we will talk about the
test life cycle.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8f5902;font-style:italic">// 1. init code
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setup</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// 2. setup code
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// 3. VU code
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">teardown</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// 4. teardown code
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Overview:</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2022/png/2601/1659421018537-928345fb-3b75-416b-bc8f-498e1bbf6488.png?x-oss-process=image%2Fresize%2Cw_1349%2Climit_0" alt="overview" title="overview"></p>
<h3 id="init-stage">init stage</h3>
<p>The init stage is required. Separating the init stage from the VU stage removes
irrelevant computation from VU code, which both improves k6 performance and
makes test results more reliable.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#8f5902;font-style:italic">// init context: importing modules
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">Trend</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/metrics&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#8f5902;font-style:italic">// init context: define k6 options
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">vus</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#000">duration</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;30s&#39;</span><span style="color:#000;font-weight:bold">,</span>
<span style="color:#000;font-weight:bold">};</span>

<span style="color:#8f5902;font-style:italic">// init context: global variables
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">customTrend</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Trend</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;oneCustomMetric&#39;</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">// init context: define custom function
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">myCustomFunction</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// ...
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>

</code></pre></div><h3 id="vu-stage">VU stage</h3>
<p>The code inside <code>default()</code> function is VU code.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// do things here...
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>VU code runs over and over through the test duration.</p>
<p>VU code can make HTTP requests, emit metrics, and generally do everything you&rsquo;d
expect a load test to do. The only exceptions are the jobs that happen in the
init context.</p>
<ul>
<li>VU code does not load files from your local filesystem.</li>
<li>VU code does not import any other modules.</li>
</ul>
<p>Again, instead of VU code, init code does these jobs.</p>
<h3 id="setup-and-teardown-stages">setup and teardown stages</h3>
<p>Like default, setup and teardown functions must be exported functions. But
unlike the default function, k6 calls setup and teardown only once per test.</p>
<p>setup is called at the beginning of the test, after the init stage but before
the VU stage. teardown is called at the end of a test, after the VU stage
(default function). You can call the full k6 API in the setup and teardown
stages, unlike the init stage. For example, you can make HTTP requests:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setup</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;https://httpbin.test.k6.io/get&#39;</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">data</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">res</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">json</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">};</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">teardown</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">JSON</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">stringify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">));</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">JSON</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">stringify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">));</span>
<span style="color:#000;font-weight:bold">}</span>


</code></pre></div><p><img src="https://k6.io/docs/static/2c69d22ae34cc91f7514f63bd2a787ea/5d70e/lifecycle.png" alt="flow" title="flow"></p>
<h2 id="running-k6">Running k6</h2>
<h3 id="first-run">first run</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">sleep</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;https://test.k6.io&#39;</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">sleep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">k6 run script.js
</code></pre></div><h3 id="options">options</h3>
<p>You can specifiy <code>--vus 10 and</code> <code>--duration 30s</code> similar way to run test each time,
or you can include the options in your js file.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">sleep</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">vus</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#000">duration</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;30s&#39;</span><span style="color:#000;font-weight:bold">,</span>
<span style="color:#000;font-weight:bold">};</span>
<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;http://test.k6.io&#39;</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">sleep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h4 id="stages-ramping-updown-vus">stages: ramping up/down VUs</h4>
<p>You can ramp the number if VUs up and down during the test.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">check</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sleep</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">stages</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
  <span style="color:#000;font-weight:bold">{</span><span style="color:#000">duration</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;5s&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">target</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">},</span>
  <span style="color:#000;font-weight:bold">{</span><span style="color:#000">duration</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;3s&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">target</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">},</span>
  <span style="color:#000;font-weight:bold">{</span><span style="color:#000">duration</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;5s&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">target</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">},</span>
  <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">};</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;https://httpbin.test.k6.io/get&#39;</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">check</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">res</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;status was 200&#39;</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">200</span><span style="color:#000;font-weight:bold">});</span>
  <span style="color:#000">sleep</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>


<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">teardown</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;test done...&#39;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h4 id="scenarios">Scenarios</h4>
<p>Benefits of using scenarios include:</p>
<ul>
<li>
<p>Multiple scenarios can be declared in the same script, and each one can
independently execute a different JavaScript function, which makes organizing
tests easier and more flexible.</p>
</li>
<li>
<p>Every scenario can use a distinct VU and iteration scheduling pattern, powered
by a purpose-built <code>executor</code>. This enables modeling of advanced execution
patterns which can better simulate real-world traffic.</p>
</li>
<li>
<p>Scenarios are independent from each other and run in parallel, though they can
be made to appear sequential by setting the startTime property of each
carefully.</p>
</li>
<li>
<p>Different environment variables and metric tags can be set per scenario.</p>
</li>
</ul>
<p>For example:</p>
<pre tabindex="0"><code class="language-jsts" data-lang="jsts">import http from 'k6/http';

export const options = {
  scenarios: {
    example_scenario: {
      executor: 'shared-iterations',
      startTime: '0s'
    },
    another_scenario: {
      executor: 'shared-iterations',
      startTime: '5s'
    },
  },
};

export default function () {
  http.get('https://google.com/');
}
</code></pre><p>Executors are the workhorses for k6 execution. Each one schedules VUs and
iterations differently, you will choose one depending on the type of traffic you
want to model to test your services, they are:</p>
<ul>
<li>
<p><strong>shared-iterations</strong>: A fixed amount of iterations are &ldquo;shared&rdquo; between a
number of VUs.</p>
</li>
<li>
<p><strong>per-vu-iterations</strong>: Each VU executes an exact number of iterations.</p>
</li>
<li>
<p><strong>constant-vus</strong>: A fixed number of VUs execute as many iterations as possible
for a specified amount of time.</p>
</li>
<li>
<p><strong>ramping-vus</strong>: A variable number of VUs execute as many iterations as
possible for a specified amount of time.</p>
</li>
<li>
<p><strong>constant-arrival-rate</strong>: A fixed number of iterations are executed in a
specified period of time.</p>
</li>
<li>
<p><strong>ramping-arrival-rate</strong>: A variable number of iterations are
executed in a specified period of time.</p>
</li>
<li>
<p><strong>externally-controlled</strong>: Control and scale execution at runtime via k6&rsquo;s
REST API or the CLI.</p>
</li>
</ul>
<p>Common options for <code>scenario</code>:</p>
<ul>
<li>
<p><strong>executor (required)</strong>: Unique executor name. See the list of possible values
in the executors (last part).</p>
</li>
<li>
<p><strong>startTime</strong>: Default set to &lsquo;0s&rsquo;. Time offset since the start of the test,
at which point this scenario should begin execution.</p>
</li>
<li>
<p><strong>gracefulStop</strong>: Default set to &rsquo;30s'. Time to wait for iterations to finish
executing before stopping them forcefully. Read more about gracefully stopping
a test run here.</p>
</li>
<li>
<p><strong>exec</strong>: Default set to &lsquo;default&rsquo;. Name of exported JS function to execute.</p>
</li>
<li>
<p><strong>env</strong>: default set to {}, Environment variables specific to this scenario.</p>
</li>
<li>
<p><strong>tags</strong>: Default set to {}, tags specific to his scenario.</p>
</li>
</ul>
<p>For example, the following script defines two minimal scenarios (1 VU, default
duration):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js">
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">scenarios</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">example_scenario</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#000">executor</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;shared-iterations&#39;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#000">startTime</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;0s&#39;</span>
    <span style="color:#000;font-weight:bold">},</span>
    <span style="color:#000">another_scenario</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#000">executor</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;shared-iterations&#39;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#000">startTime</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;5s&#39;</span>
    <span style="color:#000;font-weight:bold">},</span>
  <span style="color:#000;font-weight:bold">},</span>
<span style="color:#000;font-weight:bold">};</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;https://google.com/&#39;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>The output will be :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">          /<span style="color:#4e9a06">\ </span>     <span style="color:#000;font-weight:bold">|</span>‾‾<span style="color:#000;font-weight:bold">|</span> /‾‾/   /‾‾/
     /<span style="color:#4e9a06">\ </span> /  <span style="color:#4e9a06">\ </span>    <span style="color:#000;font-weight:bold">|</span>  <span style="color:#000;font-weight:bold">|</span>/  /   /  /
    /  <span style="color:#4e9a06">\/</span>    <span style="color:#4e9a06">\ </span>   <span style="color:#000;font-weight:bold">|</span>     <span style="color:#ce5c00;font-weight:bold">(</span>   /   ‾‾<span style="color:#4e9a06">\
</span><span style="color:#4e9a06"></span>   /          <span style="color:#4e9a06">\ </span>  <span style="color:#000;font-weight:bold">|</span>  <span style="color:#000;font-weight:bold">|</span><span style="color:#4e9a06">\ </span> <span style="color:#4e9a06">\ </span><span style="color:#000;font-weight:bold">|</span>  <span style="color:#ce5c00;font-weight:bold">(</span>‾<span style="color:#ce5c00;font-weight:bold">)</span>  <span style="color:#000;font-weight:bold">|</span>
  / __________ <span style="color:#4e9a06">\ </span> <span style="color:#000;font-weight:bold">|</span>__<span style="color:#000;font-weight:bold">|</span> <span style="color:#4e9a06">\_</span>_<span style="color:#4e9a06">\ \_</span>____/ .io

  execution: <span style="color:#204a87">local</span>
     script: .<span style="color:#4e9a06">\s</span>cenario_example.js
     output: -

  scenarios: <span style="color:#ce5c00;font-weight:bold">(</span>100.00%<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#0000cf;font-weight:bold">2</span> scenarios, <span style="color:#0000cf;font-weight:bold">2</span> max VUs, 10m35s max duration <span style="color:#ce5c00;font-weight:bold">(</span>incl. graceful stop<span style="color:#ce5c00;font-weight:bold">)</span>:
           * example_scenario: <span style="color:#0000cf;font-weight:bold">1</span> iterations shared among <span style="color:#0000cf;font-weight:bold">1</span> VUs <span style="color:#ce5c00;font-weight:bold">(</span>maxDuration: 10m0s, gracefulStop: 30s<span style="color:#ce5c00;font-weight:bold">)</span>
           * another_scenario: <span style="color:#0000cf;font-weight:bold">1</span> iterations shared among <span style="color:#0000cf;font-weight:bold">1</span> VUs <span style="color:#ce5c00;font-weight:bold">(</span>maxDuration: 10m0s, startTime: 5s, gracefulStop: 30s<span style="color:#ce5c00;font-weight:bold">)</span>


running <span style="color:#ce5c00;font-weight:bold">(</span>00m05.2s<span style="color:#ce5c00;font-weight:bold">)</span>, 0/2 VUs, <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#204a87">complete</span> and <span style="color:#0000cf;font-weight:bold">0</span> interrupted iterations
example_scenario ✓ <span style="color:#ce5c00;font-weight:bold">[======================================]</span> <span style="color:#0000cf;font-weight:bold">1</span> VUs  00m00.2s/10m0s  1/1 shared iters
another_scenario ✓ <span style="color:#ce5c00;font-weight:bold">[======================================]</span> <span style="color:#0000cf;font-weight:bold">1</span> VUs  00m00.2s/10m0s  1/1 shared iters

     data_received..................: <span style="color:#0000cf;font-weight:bold">54</span> kB  <span style="color:#0000cf;font-weight:bold">11</span> kB/s
     data_sent......................: 2.5 kB <span style="color:#0000cf;font-weight:bold">486</span> B/s
     http_req_blocked...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>53.45ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>46.56ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>48.42ms  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>70.4ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>64.25ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>67.32ms
     http_req_connecting............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>19.95ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>18.62ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>19.93ms  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>21.3ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>21.26ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>21.28ms
     http_req_duration..............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>46.16ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>25.82ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>45.6ms   <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>67.6ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>65.63ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>66.61ms
       <span style="color:#ce5c00;font-weight:bold">{</span> expected_response:true <span style="color:#ce5c00;font-weight:bold">}</span>...: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>46.16ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>25.82ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>45.6ms   <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>67.6ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>65.63ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>66.61ms
     http_req_failed................: 0.00%  ✓ <span style="color:#0000cf;font-weight:bold">0</span>        ✗ <span style="color:#0000cf;font-weight:bold">4</span>
     http_req_receiving.............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>3.56ms   <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>305.8µs  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>3.05ms   <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>7.84ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>7.01ms   p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>7.43ms
     http_req_sending...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>132.85µs <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>0s       <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>0s       <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>531.4µs  p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>371.98µs p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>451.68µs
     http_req_tls_handshaking.......: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>32.68ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>27.63ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>27.99ms  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>47.09ms  p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>41.43ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>44.26ms
     http_req_waiting...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>42.46ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>24.78ms  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>42.64ms  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>59.75ms  p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>58.45ms  p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>59.1ms
     http_reqs......................: <span style="color:#0000cf;font-weight:bold">4</span>      0.771306/s
     iteration_duration.............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>199.23ms <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>182.79ms <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>199.23ms <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>215.67ms p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>212.38ms p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>214.03ms
     iterations.....................: <span style="color:#0000cf;font-weight:bold">2</span>      0.385653/s
     vus............................: <span style="color:#0000cf;font-weight:bold">0</span>      <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>      <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span>
     vus_max........................: <span style="color:#0000cf;font-weight:bold">2</span>      <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span>      <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span>

</code></pre></div><h4 id="graceful-stop">Graceful stop</h4>
<p>This option is available for all executors except <code>externally-controlled</code> and
allows the user to specify a duration to wait before forcefully interrupting
them. The default value is <code>30s</code>.</p>
<p>For example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">check</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">sleep</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6&#39;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">http</span> <span style="color:#000">from</span> <span style="color:#4e9a06">&#39;k6/http&#39;</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">options</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">// k6 will return null as the body. The whole body will be ignored.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">// This is the default when discardResponseBodies is set to true.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">discardResponseBodies</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
  <span style="color:#000">scenarios</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">contacts</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#8f5902;font-style:italic">// A fixed number of VUs execute as many iterations as possible for
</span><span style="color:#8f5902;font-style:italic"></span>      <span style="color:#8f5902;font-style:italic">// a specified amount of time.
</span><span style="color:#8f5902;font-style:italic"></span>      <span style="color:#000">executor</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;constant-vus&#39;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#000">vus</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#000">duration</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;10s&#39;</span><span style="color:#000;font-weight:bold">,</span>
      <span style="color:#000">gracefulStop</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;3s&#39;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000;font-weight:bold">},</span>
  <span style="color:#000;font-weight:bold">},</span>
<span style="color:#000;font-weight:bold">};</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">default</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">delay</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Math</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">floor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">Math</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">random</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#8f5902;font-style:italic">// this address support a customized delayed payload.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`https://httpbin.test.k6.io/delay/</span><span style="color:#4e9a06">${</span><span style="color:#000">delay</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">// export default function () {
</span><span style="color:#8f5902;font-style:italic">//   const res = http.get(&#39;https://httpbin.test.k6.io/get&#39;);
</span><span style="color:#8f5902;font-style:italic">//   check(res, {&#39;status was 200&#39;: (r) =&gt; r.status == 200});
</span><span style="color:#8f5902;font-style:italic">//   sleep(1);
</span><span style="color:#8f5902;font-style:italic">// }
</span></code></pre></div><p>The ouput is like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">          /<span style="color:#4e9a06">\ </span>     <span style="color:#000;font-weight:bold">|</span>‾‾<span style="color:#000;font-weight:bold">|</span> /‾‾/   /‾‾/   
     /<span style="color:#4e9a06">\ </span> /  <span style="color:#4e9a06">\ </span>    <span style="color:#000;font-weight:bold">|</span>  <span style="color:#000;font-weight:bold">|</span>/  /   /  /    
    /  <span style="color:#4e9a06">\/</span>    <span style="color:#4e9a06">\ </span>   <span style="color:#000;font-weight:bold">|</span>     <span style="color:#ce5c00;font-weight:bold">(</span>   /   ‾‾<span style="color:#4e9a06">\ </span> 
   /          <span style="color:#4e9a06">\ </span>  <span style="color:#000;font-weight:bold">|</span>  <span style="color:#000;font-weight:bold">|</span><span style="color:#4e9a06">\ </span> <span style="color:#4e9a06">\ </span><span style="color:#000;font-weight:bold">|</span>  <span style="color:#ce5c00;font-weight:bold">(</span>‾<span style="color:#ce5c00;font-weight:bold">)</span>  <span style="color:#000;font-weight:bold">|</span> 
  / __________ <span style="color:#4e9a06">\ </span> <span style="color:#000;font-weight:bold">|</span>__<span style="color:#000;font-weight:bold">|</span> <span style="color:#4e9a06">\_</span>_<span style="color:#4e9a06">\ \_</span>____/ .io

  execution: <span style="color:#204a87">local</span>
     script: pt-1-0001-stages.ts
     output: -

  scenarios: <span style="color:#ce5c00;font-weight:bold">(</span>100.00%<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#0000cf;font-weight:bold">1</span> scenario, <span style="color:#0000cf;font-weight:bold">100</span> max VUs, 13s max duration <span style="color:#ce5c00;font-weight:bold">(</span>incl. graceful stop<span style="color:#ce5c00;font-weight:bold">)</span>:
           * contacts: <span style="color:#0000cf;font-weight:bold">100</span> looping VUs <span style="color:#204a87;font-weight:bold">for</span> 10s <span style="color:#ce5c00;font-weight:bold">(</span>gracefulStop: 3s<span style="color:#ce5c00;font-weight:bold">)</span>


running <span style="color:#ce5c00;font-weight:bold">(</span>13.0s<span style="color:#ce5c00;font-weight:bold">)</span>, 000/100 VUs, <span style="color:#0000cf;font-weight:bold">304</span> <span style="color:#204a87">complete</span> and <span style="color:#0000cf;font-weight:bold">27</span> interrupted iterations
contacts ✓ <span style="color:#ce5c00;font-weight:bold">[======================================]</span> <span style="color:#0000cf;font-weight:bold">100</span> VUs  10s

     data_received..................: <span style="color:#0000cf;font-weight:bold">712</span> kB <span style="color:#0000cf;font-weight:bold">55</span> kB/s
     data_sent......................: <span style="color:#0000cf;font-weight:bold">73</span> kB  5.6 kB/s
     http_req_blocked...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>334.76ms <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>2µs   <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>7µs   <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>2.54s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>945.15ms p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>996.46ms
     http_req_connecting............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>81.15ms  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>0s    <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>0s    <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>276.62ms p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>256ms    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>261.4ms 
     http_req_duration..............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>3.16s    <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>1.22s <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>3.24s <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>5.29s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>5.25s    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>5.26s   
       <span style="color:#ce5c00;font-weight:bold">{</span> expected_response:true <span style="color:#ce5c00;font-weight:bold">}</span>...: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>3.16s    <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>1.22s <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>3.24s <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>5.29s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>5.25s    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>5.26s   
     http_req_failed................: 0.00%  ✓ <span style="color:#0000cf;font-weight:bold">0</span>         ✗ <span style="color:#0000cf;font-weight:bold">304</span>  
     http_req_receiving.............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>94.97µs  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>28µs  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>87µs  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>1.02ms   p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>121µs    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>132.69µs
     http_req_sending...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>36.02µs  <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>12µs  <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>33µs  <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>495µs    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>46µs     p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>54.69µs 
     http_req_tls_handshaking.......: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>192.62ms <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>0s    <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>0s    <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>2.11s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>497.04ms p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>540.7ms 
     http_req_waiting...............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>3.16s    <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>1.22s <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>3.24s <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>5.29s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>5.25s    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>5.25s   
     http_reqs......................: <span style="color:#0000cf;font-weight:bold">304</span>    23.377036/s
     iteration_duration.............: <span style="color:#000">avg</span><span style="color:#ce5c00;font-weight:bold">=</span>3.5s     <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span>1.22s <span style="color:#000">med</span><span style="color:#ce5c00;font-weight:bold">=</span>3.25s <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span>7.79s    p<span style="color:#ce5c00;font-weight:bold">(</span>90<span style="color:#ce5c00;font-weight:bold">)=</span>5.27s    p<span style="color:#ce5c00;font-weight:bold">(</span>95<span style="color:#ce5c00;font-weight:bold">)=</span>6.1s    
     iterations.....................: <span style="color:#0000cf;font-weight:bold">304</span>    23.377036/s
     vus............................: <span style="color:#0000cf;font-weight:bold">27</span>     <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">27</span>      <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span>
     vus_max........................: <span style="color:#0000cf;font-weight:bold">100</span>    <span style="color:#000">min</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span>     <span style="color:#000">max</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span>
</code></pre></div><p>Notice that <code>running (13.0s)</code>, even though the total test duration is 10s, the
actual execution time was 13s because of <code>gracefulStop</code>, giving the VUs a 3s
additional time to complete iterations in progress. 27 iterations are
interrupted or did not complete within this window and was therefore
interrupted.</p>
<h3 id="execution-modes">Execution modes</h3>
<ul>
<li>
<p><strong>Local</strong>: the test execution happens entirely on a single machine.</p>
</li>
<li>
<p><strong>Distributed</strong>: the test execution is distributed across a K8s cluster.(I
have&rsquo;t try it yet)</p>
</li>
<li>
<p><strong>Cloud</strong>: the test execution happens on k6 clould.(I haven&rsquo;t try it yet)</p>
</li>
</ul>
<h2 id="integrate-in-emacs">integrate in Emacs</h2>
<p>Emacs supports automatic language server installation, so the first time you run
`M-x lsp`` in a JavaScript file opened in it, you will be prompted for a
language server to install. (Here I use ts lsp server)</p>
<p>Then, everything will be done by Emacs and lsp server for you.</p>
<blockquote>
<p><a href="https://emacs-lsp.github.io/lsp-mode/tutorials/reactjs-tutorial/">https://emacs-lsp.github.io/lsp-mode/tutorials/reactjs-tutorial/</a></p>
</blockquote>
<p>Commanded to use VsCode directly (with autocompletion support):</p>
<blockquote>
<p><a href="https://marketplace.visualstudio.com/items?itemName=k6.k6">https://marketplace.visualstudio.com/items?itemName=k6.k6</a></p>
</blockquote>


        </div>
      </div>
      <div class="container">
  <span class="row justify-content-center meta" id="footer">
    Copyright © 2023 Dyrone Teng
  </span>
  <script defer src="js/custom.js"></script>

</div>

    </div>
  </div>
</div>

  </body>

</html>

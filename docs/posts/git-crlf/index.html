<!doctype html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Git CRLF processing and &#39;git add --renormalize&#39; - Dyrone Teng </title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="referrer" content="no-referrer">
    <meta property="og:site_name" content="Dyrone Teng" />
    <meta property="og:locale" content="en_US" />

    <meta property="og:title" content="Git CRLF processing and &#39;git add --renormalize&#39;" />
<meta property="og:description" content="git config core.autocrlf git config core.autocrlf true
This does not force normalization of text files, but does ensure that text files that you introduce to the repository have their line endings normalized to LF when they are added, and that files that are already normalized in the repository stay normalized. git config core.autocrlf false printf &#34;LINEONE\nLINETWO\nLINETHREE&#34; &gt;LF.txt printf &#34;LINEONE\r\nLINETWO\r\nLINETHREE&#34; &gt;CRLF.txt printf &#34;LINEONE\r\nLINETWO\nLINETHREE&#34; &gt;CRLF_mix_LF.txt Ouput the CRLF.txt:
cat CRLF.txt | hexdump -C 00000000 4c 49 4e 45 4f 4e 45 0d 0a 4c 49 4e 45 54 57 4f |LINEONE." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/git-crlf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-27T15:39:04+08:00" />
<meta property="article:modified_time" content="2022-09-27T15:39:04+08:00" />



    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:title" content="Git CRLF processing and &#39;git add --renormalize&#39;" />
    <meta name="twitter:description" content="" />
    

    <meta name="twitter:image" content="" />
    <link rel="canonical" href="/posts/git-crlf/">
    
    <link rel="stylesheet" href="/css/site.min.css" />
    <link rel="stylesheet" href="css/custom.css" />

    
    
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Dyrone Teng" />
    
  </head>

  <body>
    
<div class="mt-xl header">
  <header>
    <div class="container">
      <div class="row justify-content-center">
	<div class="col-auto">
	  <a href="" style="display: contents">
	    <h1 class="name text-center">Teng Long Is Dyrone</h1>
	  </a>
	</div>
      </div>
      <div class="row justify-content-center">
	<div class="nav justify-content-center">
	  <ul>
	    
	    <li class="nav-item justify-content-center mx-auto"> 
	      <a class="nav-link" href="/">
		
		Home
	      </a>
	    </li>
	    
	    <li class="nav-item justify-content-center mx-auto"> 
	      <a class="nav-link" href="/posts/introduce/index.html">
		
		About
	      </a>
	    </li>
	    
	    
	  </ul>
	</div>
      </div>
    </div>
  </header>
</div>

<div class="content">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-lg-8">
        <h1 class="mx-0 mx-md-4 single-page-title">Git CRLF processing and &#39;git add --renormalize&#39;</h1>
        <div class="markdown page-content">
          <h2 id="git-config-coreautocrlf">git config core.autocrlf</h2>
<p>git config core.autocrlf true</p>
<pre tabindex="0"><code class="language-lang" data-lang="lang">This does not force normalization of text files, but does ensure that text files that you introduce to the repository have their line endings normalized to LF when they are added, and that files that are already normalized in the repository stay normalized.
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git config core.autocrlf <span style="color:#204a87">false</span>                                                                    
<span style="color:#204a87">printf</span> <span style="color:#4e9a06">&#34;LINEONE\nLINETWO\nLINETHREE&#34;</span> &gt;LF.txt                                                  
<span style="color:#204a87">printf</span> <span style="color:#4e9a06">&#34;LINEONE\r\nLINETWO\r\nLINETHREE&#34;</span> &gt;CRLF.txt
<span style="color:#204a87">printf</span> <span style="color:#4e9a06">&#34;LINEONE\r\nLINETWO\nLINETHREE&#34;</span>   &gt;CRLF_mix_LF.txt
</code></pre></div><p>Ouput the CRLF.txt:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat CRLF.txt  <span style="color:#000;font-weight:bold">|</span> hexdump -C                                                               
<span style="color:#0000cf;font-weight:bold">00000000</span>  4c <span style="color:#0000cf;font-weight:bold">49</span> 4e <span style="color:#0000cf;font-weight:bold">45</span> 4f 4e <span style="color:#0000cf;font-weight:bold">45</span> 0d  0a 4c <span style="color:#0000cf;font-weight:bold">49</span> 4e <span style="color:#0000cf;font-weight:bold">45</span> <span style="color:#0000cf;font-weight:bold">54</span> <span style="color:#0000cf;font-weight:bold">57</span> 4f  <span style="color:#000;font-weight:bold">|</span>LINEONE..LINETWO<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000010</span>  0d 0a 4c <span style="color:#0000cf;font-weight:bold">49</span> 4e <span style="color:#0000cf;font-weight:bold">45</span> <span style="color:#0000cf;font-weight:bold">54</span> <span style="color:#0000cf;font-weight:bold">48</span>  <span style="color:#0000cf;font-weight:bold">52</span> <span style="color:#0000cf;font-weight:bold">45</span> <span style="color:#0000cf;font-weight:bold">45</span>                 <span style="color:#000;font-weight:bold">|</span>..LINETHREE<span style="color:#000;font-weight:bold">|</span>                                                
0000001b 
</code></pre></div><p>I added some debugging information in git, and let&rsquo;s see these three files
content and object info which storing in git.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">➜  dyrone git:<span style="color:#ce5c00;font-weight:bold">(</span>master<span style="color:#ce5c00;font-weight:bold">)</span> ✗ git add .                                                                                       
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> renormalize: ok                                                                                           
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: CRLF.txt, oid:0000000000000000000000000000000000000000                                       
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 9d953959d3ccf2147bddc3bfcc3ef1d445fdec8e                                                 
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :9d953959d3ccf2147bddc3bfcc3ef1d445fdec8e  is written to odb and <span style="color:#204a87">set</span> to cached entry      
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> renormalize: ok                                                                                           
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: CRLF_mix_LF.txt, oid:0000000000000000000000000000000000000000                                
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 59a5c42c6e69fbb3a7bde1fee3c72653f41d300a                                                 
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :59a5c42c6e69fbb3a7bde1fee3c72653f41d300a  is written to odb and <span style="color:#204a87">set</span> to cached entry      
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> renormalize: ok                                                                                           
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: LF.txt, oid:0000000000000000000000000000000000000000                                         
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 27aa24b533b95695aa3b6a64350a6909bdba136d                                                 
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :27aa24b533b95695aa3b6a64350a6909bdba136d  is written to odb and <span style="color:#204a87">set</span> to cached entry      

➜  dyrone git:<span style="color:#ce5c00;font-weight:bold">(</span>master<span style="color:#ce5c00;font-weight:bold">)</span> ✗ cat .git/index<span style="color:#000;font-weight:bold">|</span> hexdump -C                                                                      
<span style="color:#0000cf;font-weight:bold">00000000</span>  <span style="color:#0000cf;font-weight:bold">44</span> <span style="color:#0000cf;font-weight:bold">49</span> <span style="color:#0000cf;font-weight:bold">52</span> <span style="color:#0000cf;font-weight:bold">43</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">02</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">03</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">61</span>  <span style="color:#000;font-weight:bold">|</span>DIRC........c1.a<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000010</span>  <span style="color:#0000cf;font-weight:bold">28</span> bf a6 <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">61</span>  <span style="color:#0000cf;font-weight:bold">28</span> bf a6 <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#0000cf;font-weight:bold">01</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">07</span>  <span style="color:#000;font-weight:bold">|</span><span style="color:#ce5c00;font-weight:bold">(</span>...c1.a<span style="color:#ce5c00;font-weight:bold">(</span>.......<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000020</span>  <span style="color:#0000cf;font-weight:bold">07</span> <span style="color:#0000cf;font-weight:bold">06</span> a0 b1 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">81</span> a4  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">01</span> f5 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">14</span>  <span style="color:#000;font-weight:bold">|</span>................<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000030</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> 1b 9d <span style="color:#0000cf;font-weight:bold">95</span> <span style="color:#0000cf;font-weight:bold">39</span> <span style="color:#0000cf;font-weight:bold">59</span>  d3 cc f2 <span style="color:#0000cf;font-weight:bold">14</span> 7b dd c3 bf  <span style="color:#000;font-weight:bold">|</span>......9Y....<span style="color:#ce5c00;font-weight:bold">{</span>...<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000040</span>  cc 3e f1 d4 <span style="color:#0000cf;font-weight:bold">45</span> fd ec 8e  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">08</span> <span style="color:#0000cf;font-weight:bold">43</span> <span style="color:#0000cf;font-weight:bold">52</span> 4c <span style="color:#0000cf;font-weight:bold">46</span> 2e <span style="color:#0000cf;font-weight:bold">74</span>  <span style="color:#000;font-weight:bold">|</span>.&gt;..E.....CRLF.t<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000050</span>  <span style="color:#0000cf;font-weight:bold">78</span> <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">67</span>  <span style="color:#0000cf;font-weight:bold">04</span> 3f b3 dc <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">67</span>  <span style="color:#000;font-weight:bold">|</span>xt..c1.g.?..c1.g<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000060</span>  <span style="color:#0000cf;font-weight:bold">04</span> 3f b3 dc <span style="color:#0000cf;font-weight:bold">01</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">07</span>  <span style="color:#0000cf;font-weight:bold">07</span> <span style="color:#0000cf;font-weight:bold">06</span> a0 c0 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">81</span> a4  <span style="color:#000;font-weight:bold">|</span>.?..............<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000070</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">01</span> f5 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">14</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> 1a <span style="color:#0000cf;font-weight:bold">59</span> a5 c4 2c  <span style="color:#000;font-weight:bold">|</span>............Y..,<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000080</span>  6e <span style="color:#0000cf;font-weight:bold">69</span> fb b3 a7 bd e1 fe  e3 c7 <span style="color:#0000cf;font-weight:bold">26</span> <span style="color:#0000cf;font-weight:bold">53</span> f4 1d <span style="color:#0000cf;font-weight:bold">30</span> 0a  <span style="color:#000;font-weight:bold">|</span>ni........<span style="color:#000;font-weight:bold">&amp;</span>S..0.<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000090</span>  <span style="color:#0000cf;font-weight:bold">00</span> 0f <span style="color:#0000cf;font-weight:bold">43</span> <span style="color:#0000cf;font-weight:bold">52</span> 4c <span style="color:#0000cf;font-weight:bold">46</span> 5f 6d  <span style="color:#0000cf;font-weight:bold">69</span> <span style="color:#0000cf;font-weight:bold">78</span> 5f 4c <span style="color:#0000cf;font-weight:bold">46</span> 2e <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">78</span>  <span style="color:#000;font-weight:bold">|</span>..CRLF_mix_LF.tx<span style="color:#000;font-weight:bold">|</span>                                           
000000a0  <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">56</span>  <span style="color:#0000cf;font-weight:bold">02</span> ab 2e a6 <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">56</span>  <span style="color:#000;font-weight:bold">|</span>t...c1.V....c1.V<span style="color:#000;font-weight:bold">|</span>                                           
000000b0  <span style="color:#0000cf;font-weight:bold">02</span> ab 2e a6 <span style="color:#0000cf;font-weight:bold">01</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">07</span>  <span style="color:#0000cf;font-weight:bold">07</span> <span style="color:#0000cf;font-weight:bold">06</span> a0 <span style="color:#0000cf;font-weight:bold">90</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">81</span> a4  <span style="color:#000;font-weight:bold">|</span>................<span style="color:#000;font-weight:bold">|</span>                                           
000000c0  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">01</span> f5 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">14</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">19</span> <span style="color:#0000cf;font-weight:bold">27</span> aa <span style="color:#0000cf;font-weight:bold">24</span> b5  <span style="color:#000;font-weight:bold">|</span>............<span style="color:#a40000">&#39;</span>.$.<span style="color:#000;font-weight:bold">|</span>                                           
000000d0  <span style="color:#0000cf;font-weight:bold">33</span> b9 <span style="color:#0000cf;font-weight:bold">56</span> <span style="color:#0000cf;font-weight:bold">95</span> aa 3b 6a <span style="color:#0000cf;font-weight:bold">64</span>  <span style="color:#0000cf;font-weight:bold">35</span> 0a <span style="color:#0000cf;font-weight:bold">69</span> <span style="color:#0000cf;font-weight:bold">09</span> bd ba <span style="color:#0000cf;font-weight:bold">13</span> 6d  <span style="color:#000;font-weight:bold">|</span>3.V..<span style="color:#000;font-weight:bold">;</span>jd5.i....m<span style="color:#000;font-weight:bold">|</span>                                           
000000e0  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">06</span> 4c <span style="color:#0000cf;font-weight:bold">46</span> 2e <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">78</span> <span style="color:#0000cf;font-weight:bold">74</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">08</span> <span style="color:#0000cf;font-weight:bold">09</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">33</span>  <span style="color:#000;font-weight:bold">|</span>..LF.txt......c3<span style="color:#000;font-weight:bold">|</span>                                           
000000f0  e9 <span style="color:#0000cf;font-weight:bold">73</span> e8 e5 be <span style="color:#0000cf;font-weight:bold">78</span> <span style="color:#0000cf;font-weight:bold">69</span> a9  f8 <span style="color:#0000cf;font-weight:bold">32</span> 0c <span style="color:#0000cf;font-weight:bold">77</span> <span style="color:#0000cf;font-weight:bold">60</span> be <span style="color:#0000cf;font-weight:bold">42</span> bc  <span style="color:#000;font-weight:bold">|</span>.s...xi..2.w<span style="color:#4e9a06">`</span>.B.<span style="color:#000;font-weight:bold">|</span>                                           
<span style="color:#0000cf;font-weight:bold">00000100</span>   
</code></pre></div><p>We can grab the key informations in above outputs. When we close the config <code>git config core.autocrlf</code>, we can see that there are 3 actually different BLOBs that
be written into INDEX. They are :</p>
<ul>
<li>9d953959d3ccf2147bddc3bfcc3ef1d445fdec8e</li>
<li>59a5c42c6e69fbb3a7bde1fee3c72653f41d300a</li>
<li>27aa24b533b95695aa3b6a64350a6909bdba136d</li>
</ul>
<p>That is because git is not let &ldquo;autocrlf&rdquo; happen now, git will record the
original file content as the BLOB, because of the type and number of newlines,
they vary from BLOB to BLOB.</p>
<h2 id="attribute-textauto">Attribute &ldquo;text=auto&rdquo;</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;*.txt text=auto&#34;</span> &gt;.gitattributes
</code></pre></div><blockquote>
<p>If you want to ensure that text files that any contributor introduces to the
repository have their line endings normalized, you can set the text attribute
to &ldquo;auto&rdquo; for all files.</p>
<p>如果你希望确保写入仓库中的换行符都是经过&quot;规范化的（LF）&quot;, 那么你可以将对应的文
件类型的attribute设置为“auto”来满足这一点。</p>
</blockquote>
<p>我们还可以更加的灵活控制不同文件类型处理换行的不同行为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">*   <span style="color:#000">text</span><span style="color:#ce5c00;font-weight:bold">=</span>auto
*.txt		text
*.vcproj	text <span style="color:#000">eol</span><span style="color:#ce5c00;font-weight:bold">=</span>crlf
*.sh		text <span style="color:#000">eol</span><span style="color:#ce5c00;font-weight:bold">=</span>lf
*.jpg		-text
</code></pre></div><p>When we execute the above command &ldquo;*.txt text=auto&rdquo; to modify the corresponding
attributes, it is equivalent to requiring git to &ldquo;normalize (all convert to LF)
the text objects that are subsequently written to the warehouse.</p>
<p>当我们执行了上面的命令&rdquo;*.txt text=auto&quot;修改了对应的属性后，等同于我们要求git对于
后续写入仓库的文本对象，都进行“规范化（均转化为LF）。</p>
<h2 id="git-add---renormalize">git add &ndash;renormalize</h2>
<p>We can use the &ldquo;&ndash;renormalize&rdquo; parameter of the &ldquo;add&rdquo; self-command to
re-&ldquo;normalize&rdquo; the text files in the warehouse. For example, in the above
warehouse, among the three files, one is based on CRLF line breaks, and one is
The files are mixed with CRLF and LF, then these two files are actually the
files that need to be &ldquo;renormalized&rdquo;</p>
<p>我们可以使用“add” 自命令的“&ndash;renormalize” 参数来仓库中文本文件进行重新“规范化”，
例如我们针对上述的仓库中的情况，3个文件中，1个文件为基于CRLF换行，1个文件为CRLF
和LF混用，那么这两个文件实际上就是需要被“renormalized” 的文件。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">➜  dyrone git:<span style="color:#ce5c00;font-weight:bold">(</span>master<span style="color:#ce5c00;font-weight:bold">)</span> ✗ git add --renormalize <span style="color:#4e9a06">&#34;*.txt&#34;</span>                                                                                  
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: CRLF.txt, oid:0000000000000000000000000000000000000000                                                      
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 27aa24b533b95695aa3b6a64350a6909bdba136d                                                                
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :27aa24b533b95695aa3b6a64350a6909bdba136d  is written to odb and <span style="color:#204a87">set</span> to cached entry                     
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: CRLF_mix_LF.txt, oid:0000000000000000000000000000000000000000                                               
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 27aa24b533b95695aa3b6a64350a6909bdba136d                                                                
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :27aa24b533b95695aa3b6a64350a6909bdba136d  is written to odb and <span style="color:#204a87">set</span> to cached entry                     
<span style="color:#ce5c00;font-weight:bold">[</span>index_path<span style="color:#ce5c00;font-weight:bold">][</span>S_IFREG<span style="color:#ce5c00;font-weight:bold">]</span> path: LF.txt, oid:0000000000000000000000000000000000000000                                                        
<span style="color:#ce5c00;font-weight:bold">[</span>index_fd<span style="color:#ce5c00;font-weight:bold">]</span> after index fd: oid: 27aa24b533b95695aa3b6a64350a6909bdba136d                                                                
<span style="color:#ce5c00;font-weight:bold">[</span>add_to_index<span style="color:#ce5c00;font-weight:bold">]</span> index_path, oid :27aa24b533b95695aa3b6a64350a6909bdba136d  is written to odb and <span style="color:#204a87">set</span> to cached entry                     
➜  dyrone git:<span style="color:#ce5c00;font-weight:bold">(</span>master<span style="color:#ce5c00;font-weight:bold">)</span> ✗ cat .git/index<span style="color:#000;font-weight:bold">|</span> hexdump -C                                                                                     
<span style="color:#0000cf;font-weight:bold">00000000</span>  <span style="color:#0000cf;font-weight:bold">44</span> <span style="color:#0000cf;font-weight:bold">49</span> <span style="color:#0000cf;font-weight:bold">52</span> <span style="color:#0000cf;font-weight:bold">43</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">02</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">03</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">61</span>  <span style="color:#000;font-weight:bold">|</span>DIRC........c1.a<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000010</span>  <span style="color:#0000cf;font-weight:bold">28</span> bf a6 <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">61</span>  <span style="color:#0000cf;font-weight:bold">28</span> bf a6 <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#0000cf;font-weight:bold">01</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">07</span>  <span style="color:#000;font-weight:bold">|</span><span style="color:#ce5c00;font-weight:bold">(</span>...c1.a<span style="color:#ce5c00;font-weight:bold">(</span>.......<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000020</span>  <span style="color:#0000cf;font-weight:bold">07</span> <span style="color:#0000cf;font-weight:bold">06</span> a0 b1 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">81</span> a4  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">01</span> f5 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">14</span>  <span style="color:#000;font-weight:bold">|</span>................<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000030</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> 1b <span style="color:#0000cf;font-weight:bold">27</span> aa <span style="color:#0000cf;font-weight:bold">24</span> b5  <span style="color:#0000cf;font-weight:bold">33</span> b9 <span style="color:#0000cf;font-weight:bold">56</span> <span style="color:#0000cf;font-weight:bold">95</span> aa 3b 6a <span style="color:#0000cf;font-weight:bold">64</span>  <span style="color:#000;font-weight:bold">|</span>....<span style="color:#4e9a06">&#39;.$.3.V..;jd|                                                          
</span><span style="color:#4e9a06">00000040  35 0a 69 09 bd ba 13 6d  00 08 43 52 4c 46 2e 74  |5.i....m..CRLF.t|                                                          
</span><span style="color:#4e9a06">00000050  78 74 00 00 63 31 8f 67  04 3f b3 dc 63 31 8f 67  |xt..c1.g.?..c1.g|                                                          
</span><span style="color:#4e9a06">00000060  04 3f b3 dc 01 00 00 07  07 06 a0 c0 00 00 81 a4  |.?..............|                                                          
</span><span style="color:#4e9a06">00000070  00 00 01 f5 00 00 00 14  00 00 00 1a 27 aa 24 b5  |............&#39;</span>.$.<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000080</span>  <span style="color:#0000cf;font-weight:bold">33</span> b9 <span style="color:#0000cf;font-weight:bold">56</span> <span style="color:#0000cf;font-weight:bold">95</span> aa 3b 6a <span style="color:#0000cf;font-weight:bold">64</span>  <span style="color:#0000cf;font-weight:bold">35</span> 0a <span style="color:#0000cf;font-weight:bold">69</span> <span style="color:#0000cf;font-weight:bold">09</span> bd ba <span style="color:#0000cf;font-weight:bold">13</span> 6d  <span style="color:#000;font-weight:bold">|</span>3.V..<span style="color:#000;font-weight:bold">;</span>jd5.i....m<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000090</span>  <span style="color:#0000cf;font-weight:bold">00</span> 0f <span style="color:#0000cf;font-weight:bold">43</span> <span style="color:#0000cf;font-weight:bold">52</span> 4c <span style="color:#0000cf;font-weight:bold">46</span> 5f 6d  <span style="color:#0000cf;font-weight:bold">69</span> <span style="color:#0000cf;font-weight:bold">78</span> 5f 4c <span style="color:#0000cf;font-weight:bold">46</span> 2e <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">78</span>  <span style="color:#000;font-weight:bold">|</span>..CRLF_mix_LF.tx<span style="color:#000;font-weight:bold">|</span>                                                          
000000a0  <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">56</span>  <span style="color:#0000cf;font-weight:bold">02</span> ab 2e a6 <span style="color:#0000cf;font-weight:bold">63</span> <span style="color:#0000cf;font-weight:bold">31</span> 8f <span style="color:#0000cf;font-weight:bold">56</span>  <span style="color:#000;font-weight:bold">|</span>t...c1.V....c1.V<span style="color:#000;font-weight:bold">|</span>                                                          
000000b0  <span style="color:#0000cf;font-weight:bold">02</span> ab 2e a6 <span style="color:#0000cf;font-weight:bold">01</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">07</span>  <span style="color:#0000cf;font-weight:bold">07</span> <span style="color:#0000cf;font-weight:bold">06</span> a0 <span style="color:#0000cf;font-weight:bold">90</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">81</span> a4  <span style="color:#000;font-weight:bold">|</span>................<span style="color:#000;font-weight:bold">|</span>                                                          
000000c0  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">01</span> f5 <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">14</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">19</span> <span style="color:#0000cf;font-weight:bold">27</span> aa <span style="color:#0000cf;font-weight:bold">24</span> b5  <span style="color:#000;font-weight:bold">|</span>............<span style="color:#a40000">&#39;</span>.$.<span style="color:#000;font-weight:bold">|</span>                                                          
000000d0  <span style="color:#0000cf;font-weight:bold">33</span> b9 <span style="color:#0000cf;font-weight:bold">56</span> <span style="color:#0000cf;font-weight:bold">95</span> aa 3b 6a <span style="color:#0000cf;font-weight:bold">64</span>  <span style="color:#0000cf;font-weight:bold">35</span> 0a <span style="color:#0000cf;font-weight:bold">69</span> <span style="color:#0000cf;font-weight:bold">09</span> bd ba <span style="color:#0000cf;font-weight:bold">13</span> 6d  <span style="color:#000;font-weight:bold">|</span>3.V..<span style="color:#000;font-weight:bold">;</span>jd5.i....m<span style="color:#000;font-weight:bold">|</span>                                                          
000000e0  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">06</span> 4c <span style="color:#0000cf;font-weight:bold">46</span> 2e <span style="color:#0000cf;font-weight:bold">74</span> <span style="color:#0000cf;font-weight:bold">78</span> <span style="color:#0000cf;font-weight:bold">74</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">54</span> <span style="color:#0000cf;font-weight:bold">52</span> <span style="color:#0000cf;font-weight:bold">45</span> <span style="color:#0000cf;font-weight:bold">45</span>  <span style="color:#000;font-weight:bold">|</span>..LF.txt....TREE<span style="color:#000;font-weight:bold">|</span>                                                          
000000f0  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">06</span> <span style="color:#0000cf;font-weight:bold">00</span> 2d <span style="color:#0000cf;font-weight:bold">31</span> <span style="color:#0000cf;font-weight:bold">20</span>  <span style="color:#0000cf;font-weight:bold">30</span> 0a 2c <span style="color:#0000cf;font-weight:bold">57</span> b8 <span style="color:#0000cf;font-weight:bold">88</span> a3 <span style="color:#0000cf;font-weight:bold">06</span>  <span style="color:#000;font-weight:bold">|</span>.....-1 0.,W....<span style="color:#000;font-weight:bold">|</span>                                                          
<span style="color:#0000cf;font-weight:bold">00000100</span>  fb <span style="color:#0000cf;font-weight:bold">28</span> 5f 7a <span style="color:#0000cf;font-weight:bold">59</span> 5b b6 <span style="color:#0000cf;font-weight:bold">79</span>  <span style="color:#0000cf;font-weight:bold">00</span> <span style="color:#0000cf;font-weight:bold">18</span> bc <span style="color:#0000cf;font-weight:bold">29</span> 1c <span style="color:#0000cf;font-weight:bold">98</span>        <span style="color:#000;font-weight:bold">|</span>.<span style="color:#ce5c00;font-weight:bold">(</span>_zY<span style="color:#ce5c00;font-weight:bold">[</span>.y...<span style="color:#ce5c00;font-weight:bold">)</span>..<span style="color:#000;font-weight:bold">|</span>                                             
0000010e  

</code></pre></div><p>We can see that &ldquo;&ndash;renormalize&rdquo; re-&ldquo;normalizes&rdquo; the txt files in our workspace,
which turns all three files in the repository into LF as newlines. Behind this,
it is actually a two-step operation. The first step is to regenerate a new BLOB
object, and the second step is to write INDEX.</p>
<p>We can see from the output that when the renormalization is completed, the BLOBs
of the three files have become the same object
27aa24b533b95695aa3b6a64350a6909bdba136d, and at this time we can see that the
HASH of the three BLOB objects in INDEX have also been unified to
27aa24b533b95695aa3b6a64350a6909bdba136d .</p>
<p>But it should be noted that although the contents of the three files stored in
the git repository are exactly the same, the filesize of the three files in the
actual INDEX are still different, because the entry in INDEX represents the file
in the workspace and the file in git The mapping between the stored objects,
although the BLOB stored in git is unified after renormalization, the file
stat() stored in the local workspace has not actually changed.</p>
<p>我们可以看到， &ldquo;&ndash;renormalize&rdquo; 让我们workspace中的txt文件进行重新“规范化”, 这让
仓库中的三个文件全部变为LF作为换行符。这背后，其实是两步的操作，第一步是重新生成
新的BLOB对象，第二步写入INDEX。</p>
<p>我们可以从输出中看到， 当重新规范化执行结束之后，三个文件的BLOB已经变成了同一个
对象27aa24b533b95695aa3b6a64350a6909bdba136d, 而此时我们可以看到INDEX中的三个
BLOB对象的HASH也都已经统一为27aa24b533b95695aa3b6a64350a6909bdba136d.</p>
<p>但是需要注意的一点是，虽然三个文件在git仓库中存储的内容是完全一致，但是实际 上
INDEX中三个文件的filesize还是不同的，因为INDEX中entry代表的是工作空间中的文件与
git中存储的对象之间的映射，虽然renormalize后， git中存储的BLOB得到了统一，但是实
际上存储在本地工作空间中的文件stat()并没有发生变化。</p>


        </div>
      </div>
      <div class="container">
  <span class="row justify-content-center meta" id="footer">
    Copyright © 2023 Dyrone Teng
  </span>
  <script defer src="js/custom.js"></script>

</div>

    </div>
  </div>
</div>

  </body>

</html>
